<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>user media</title>
</head>
<style>
    video {
        width: 100%;
        height: 100%;
        background-color: red;
    }
</style>

<body>

<section id="app">
    <video id="show" autoplay></video>
</section>

<script>
function init(){
    var video = document.getElementById("show");
    var app = document.getElementById("app");
    if (!navigator.getUserMedia) {
        alert('没有 navigator.getUserMedia.\n navigator.userAgent: ' + navigator.userAgent);
        alert('是否有 mediaDevices.getUserMedia :', !!navigator.mediaDevices.getUserMedia)
        return;
    }
    navigator.getUserMedia({audio:true, video:true}, function(stream) {
        alert('get stream success: ' + stream);
        try {
            video.srcObject = stream;
        } catch(e) {
            alert('srcObject error: ' + err.name + '\n' +  err.message)
            video.src = URL.createObjectURL(stream);
        }
        // app.hidden = false;
    }, function(err) {
        alert('err: ' + err.name + '\n' +  err.message)
    });
    // navigator.mediaDevices.getUserMedia({ audio: true, video: true }).then(function(stream) {
    //     video.srcObject = stream;
    //     app.hidden = false;
    // }).catch(function(err) {
    //     alert('err: ' + err.name + '\n' +  err.message)
    // });
    // function gotStream(stream) {
    //     var URL = window.webkitURL ? window.webkitURL : window.URL;
    //     video.src = URL.createObjectURL(stream);
    //     app.hidden = false;
    // }
}
init();
</script>

</script>
</body>
</html>
